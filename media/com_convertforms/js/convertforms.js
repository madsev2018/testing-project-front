jQuery(function(e){e.fn.convertForms=function(){var r=this,o=e.extend({plugin:"ConvertForms",baseurl:"/",debug:!1},ConvertFormsConfig),t={INIT:"Initialized",SUBMIT:"Submitting form",SUBMIT_SUCCESS:"Successful submission",SUBMIT_ERROR:"Submission failed",REDIRECT:"Redirecting to",NO_ELEMENTS:"No elements found on this page. Aborting.",EMPTY_RESPONSE:"Empty Response"};function n(e,r){e.addClass("cf-error"),e.find(".cf-response").html(r),s("Error: "+r)}function s(e){o.debug&&console.log("["+o.plugin+"] "+e)}return function(){if(!r.length)return void s(t.NO_ELEMENTS);s(t.INIT),r.each(function(){var r=e(this);if(r.hasClass("cf-init"))return!0;var i,a=r.find("form");(i=a).on("submit",function(){var r;return r=i,s(t.SUBMIT),box=r.closest(".cf"),button=r.find("button.cf-btn"),e.ajax({type:"POST",url:o.baseurl+"index.php?option=com_ajax&format=raw&plugin=convertforms&task=submit",data:r.serialize(),success:function(o){if(o){try{o=JSON.parse(o)}catch(e){matches=o.match(/{([^}]*)}/i),null!==matches?o=JSON.parse(matches[0]):n(box,e+"<br>"+o)}if(o.success){switch(box.trigger("onSuccess",o),box.trigger("success",o),s(t.SUBMIT_SUCCESS),o.task){case"msg":box.addClass("cf-success"),box.find(".cf-response").html(o.value),"1"==o.resetform&&r[0].reset();break;case"url":url=o.value,"1"==o.passdata&&(url+=(o.value.indexOf("?")>-1?"&":"?")+(i={},r.find("input, select, textarea").filter("[name^=cf]").each(function(){name=e(this).attr("name").match(/cf\[(.*)\]/)[1],value=e(this).val(),i[name]=value}),e.param(i))),s(t.REDIRECT+" "+url),window.location.href=url}box.trigger("afterTask",o)}else box.trigger("onFail",o),box.trigger("fail",o),n(box,o.error),box.find(".cf-fields > .cf-control-group:first .cf-input").focus();var i}else n(box,t.EMPTY_RESPONSE)},error:function(e,r,o){n(box,o)},beforeSend:function(){box.trigger("onBeforeSubmit"),box.trigger("beforeSubmit"),box.addClass("cf-working cf-disabled"),box.removeClass("cf-success cf-error")},complete:function(){e(window).trigger("convertFormsAfterSubmit",box),box.trigger("onAfterSubmit"),box.trigger("afterSubmit"),box.removeClass("cf-working cf-disabled")}}),!1}),r.addClass("cf-init")})}(),this},e(window).ready(function(){e(".convertforms").convertForms()})});